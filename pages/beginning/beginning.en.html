<div class="shmakowiki"><h2>What is BEM?</h2><p>This article describes theoretical aspects of web-developing in one big company. Except the theory certainly we have practical things such as libraries and tools. There are links to them in the article.</p><p>There is plenty of sites developed at Yandex, thousands of pages. The approaches we use for HTML/CSS markup and for others front end code are permanentaly evolving.</p><p>Projects developed for a big portal and the process of developing for such usually have a range of specifics.</p><ul><li>Typical projects ought to be developed fast, but they should live long<br/>
   It needs to be able to create a project in a short period of time with an
   architecture which helps to maintain it for a long time.</li><li>Numerous people work for a project<br/>
   It has to be able to organize work efficiently for teams either of
   1-2 developers or larger numbers.</li><li>Team scalability<br/>
   The adding of new people to a team has to improve its productivity. There needs
   to exist an ability to commit new developers to work and assign them their
   own parts of the project.<br/>
   To be able to work with the same code for a long time with different members of
   the team, the code has to be well-structured.</li><li>Code reuse<br/>
   New projects of an interface element don&apos;t have to be written from
   scratch. If there is a similar task done for the company, it needs to maximize
   reuse of the code derived.</li></ul><p>We looked for solutions to our problems. And at one point they became <tt>BEM methodology</tt>.<br/> <tt>BEM</tt> means Block, Elemen, Modifier. The meanings of these terms are given further in the article.</p><p>One of the most widespread example of a methodology in  programming is OOP. OOP is a programming paradigm embodied by a lot of languages. The same applies for BEM methodology. This is a manner to describe reality in code, a range of patterns and a way of thinking about entities whatever programming language is used.<br/> Based on this methodology we devised some fon tend developing approaches and technical solutions which make us put out new pages fast and maintain existing pages easily.</p><p>The principles of our code and work process are the following:</p><h2>Unified data domain</h2><p>Imagine an ordinary site. The same as in a picture.</p><div style="text-align:center">
<img src="images/site.png"/>
</div><p>While developing and maintainting a site it is useful to mark out &quot;blocks&quot; of which the site consists.<br/> For example, in this picture there are <tt>Head</tt>, <tt>Main Layout</tt> and <tt>Foot</tt>. The Head in-turn consists of <tt>Logo</tt>, <tt>Search</tt>, <tt>Auth block</tt> and <tt>Menu</tt>. The Main Layout contains <tt>Page Title</tt> and <tt>Text Block</tt>.</p><div style="text-align:center">
<img src="images/site-marked.png"/>
</div><p>If each part of the page has its own name, it will be very useful when it comes to team communication.<br/> A manager can ask:</p><ul><li>to enlarge the <tt>Head</tt> or</li><li>to create one more page with a <tt>Head</tt> without <tt>Search</tt></li></ul><p>You can ask a JavaScript developer</p><ul><li>to make <tt>Auth Block</tt> animated, etc.</li></ul><p>That is</p><h3>Block</h3><p>We call as <tt>block</tt> an independent entity, a &quot;building block&quot; of a application. A block can be either simple or complicated (containing other blocks).</p><p><b>e.g.</b><br/> Search form block<br/></p><div style="text-align:center">
<img src="images/search-block.png"/>
</div><h3>Element</h3><p>An Element is a part of a block that performs a certain function. There&apos;s no point of element without its block.</p><p><b>e.g.</b><br/> An input field and a button are elements of the Search Block</p><div style="text-align:center">
<img src="images/search-block-marked.png"/>
</div><h2>Facilities of describing pages and templates</h2><p>Blocks and elements are a page&apos;s content. Besides the fact of being on the page, their arrangement is also important.</p><p>Blocks (or elements) can be situated in a special order:</p><p>For example, a list of goods in an Internet shop:</p><div style="text-align:center">
<img src="images/goods-list.png"/>
</div><p>Or menu items:</p><div style="text-align:center">
<img src="images/menu-items.png"/>
</div><p>A block can be included in another:</p><p>For example, a <tt>Head Block</tt> includes other blocks:</p><div style="text-align:center">
<img src="images/head-marked.png"/>
</div><p>There has to be a way to describe a page in text to be able to change the page&apos;s content, to add new blocks and to move the blocks within the page. That requires each block and element to have a key word.</p><p>A key word designating a concrete block is called <tt>block name</tt>.</p><p>For example, <tt>menu</tt> is a key word for <tt>Menu Block</tt>, or <tt>head</tt> is a key work fod a <tt>Head</tt>.</p><p>A key word designating an element is called <tt>element name</tt>.</p><p>For example, each point of a menu is an element <tt>item</tt> of <tt>menu</tt> block.</p><p>Block name must be unique, it unequivocally designates which block is described. Only the same blocks can have same block names. In this case we speak that one block is represented on the page 2 (3, 4, ...) times.</p><p>An element name must be unique only within the scope of block. An element can be repeated several times. For example, menu items.</p><div style="text-align:center">
<img src="images/menu-items.png"/>
</div><p>It&apos; necessary to place the key words in certain order. Data formats with nesting will do for it. For example, XML or JSON:</p><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:page<span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:head<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:menu<span class="ohl-punctuation">&gt;</span></span>
      ...
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>b:menu<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:column<span class="ohl-punctuation">&gt;</span></span>
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:logo<span class="ohl-punctuation">/&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>e:column<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:column<span class="ohl-punctuation">&gt;</span></span>
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:search<span class="ohl-punctuation">&gt;</span></span>
        <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:input<span class="ohl-punctuation">/&gt;</span></span>
        <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:button<span class="ohl-punctuation">&gt;</span></span>Search<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>e:button<span class="ohl-punctuation">&gt;</span></span>
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>b:search<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>e:column<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:column<span class="ohl-punctuation">&gt;</span></span>
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:auth<span class="ohl-punctuation">&gt;</span></span>
        ...
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>b:auth<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:column<span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>b:head<span class="ohl-punctuation">&gt;</span></span>
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>b:page<span class="ohl-punctuation">&gt;</span></span></code></pre><p>In this example namespaces <tt>b</tt> and <tt>e</tt> separate block nodes from element nodes.</p><p>The same in JSON:</p><pre class="ohl ohl-js"><code><span class="ohl-punctuation">{</span>
  <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>page<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
  <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">{</span>
    <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>head<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
    <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">[</span>
      <span class="ohl-punctuation">{</span> <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-operator">.</span><span class="ohl-operator">.</span><span class="ohl-operator">.</span> <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
      <span class="ohl-punctuation">{</span>
        <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>column<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
        <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">{</span> <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>logo<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-punctuation">}</span>
      <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
      <span class="ohl-punctuation">{</span>
        <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>column<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
        <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">[</span>
          <span class="ohl-punctuation">{</span>
            <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>search<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
            <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">[</span>
              <span class="ohl-punctuation">{</span> <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>input<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
              <span class="ohl-punctuation">{</span>
                <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>button<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
                <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>Search<span class="ohl-punctuation">&apos;</span></span>
              <span class="ohl-punctuation">}</span>
            <span class="ohl-punctuation">]</span>
          <span class="ohl-punctuation">}</span>
        <span class="ohl-punctuation">]</span>
      <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
      <span class="ohl-punctuation">{</span>
        <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>column<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
        <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">{</span>
          <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>auth<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
          <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-operator">.</span><span class="ohl-operator">.</span><span class="ohl-operator">.</span>
        <span class="ohl-punctuation">}</span>
      <span class="ohl-punctuation">}</span>
    <span class="ohl-punctuation">]</span>
  <span class="ohl-punctuation">}</span>
<span class="ohl-punctuation">}</span></code></pre><p>The examples above show the object model with a nesting for blocks and elements to other blocks. There is also optional data in the page description.<br/> This structure we call <tt>BEM tree</tt> (on analogy from DOM tree).</p><p>Final HTML for a browser comes from BEM tree by applying templates (for example, XSL or Javascript).</p><p>If a developer needs to move a block to a different place on the page, it&apos;s done by changing a tree. Templates make the final view themselves.</p><p>In our last products we&apos;ve gone with JSON as a format for describing a page. It turns into HTML by a JavaScript-based template engine.<br/> The links for concrete tools can be found at the end of this article.</p><h2>Block independence</h2><p>While developing a long-term project there could be a desire to move a block.<br/> E.g.</p><ul><li>to swap <tt>Logo</tt> and <tt>Auth Block</tt> or</li><li>to place <tt>Menu</tt> under <tt>Search Block</tt></li></ul><div style="text-align: center">
<img src="images/head.png"/>
</div><div style="text-align: center">
<img src="images/head-changed.png"/>
</div><p>To make this process easier blocks must be <tt>independent</tt>.</p><p>An <tt>independent</tt> block is implemented so that it can be placed anywhere on the page. And to be included in another block as well.</p><h3>Independent CSS</h3><p>From block&apos;s CSS view point this mean that</p><ul><li>A block (or an element) must have a unique &quot;name&quot; for which can be written a CSS rule.
   E.g., a class.</li><li>There mustn&apos;t be CSS selectors for tags.</li><li>Cascade selectors for several blocks should be avoided.</li></ul><h4>Naming for independent CSS classes</h4><p>One of possible namings for CSS classes satisfying the requirements is the following:</p><ul><li>CSS class for a block coincide with its <tt>block name</tt></li></ul><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>ul <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  ...
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>ul<span class="ohl-punctuation">&gt;</span></span></code></pre><ul><li>CSS class for an element is a <tt>block name</tt> and an <tt>element name</tt> divided
 by a symbol (or symbols)</li></ul><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>ul <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>li <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__item<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
    ...
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>li<span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>li <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__item<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
    ...
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>li<span class="ohl-punctuation">&gt;</span></span>
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>ul<span class="ohl-punctuation">&gt;</span></span></code></pre><p>It is necessary to include a block name in a CSS class for an element to minimize a cascade.</p><p>Naming rules for CSS classes can be different. Read <a href="http://bem.github.com/bem-bl/pages/naming/naming.eb.wiki">here</a> about a naming convention we use.</p><h3>Independent templates</h3><p>From template engine&apos;s point of view block independence means that:</p><ul><li>Blocks and elements must be described in incoming data<br/>
   A block (or an element) must have a unique &quot;name&quot; for the possibility to tell a template engine
   &quot;The Menu must be placed here&quot;.</li><li>A block can be easily placed in every place in BEM tree</li></ul><h4>Independent templates for blocks</h4><p>Comingupon the block in the incoming data a template engine must unambiguously transform it into HTML. Every block must have its template for that.</p><p>For example, this can look like this in XSL:</p><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>xsl:template <span class="ohl-name ohl-name-attribute">match<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>b:menu<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>ul <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>xsl:apply-templates<span class="ohl-punctuation">/&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>ul<span class="ohl-punctuation">&gt;</span></span>
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>xsl:template<span class="ohl-punctuation">&gt;</span></span>

<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>xsl:template <span class="ohl-name ohl-name-attribute">match<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>b:menu/e:item<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>li <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__item<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>xsl:apply-templates<span class="ohl-punctuation">/&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>li<span class="ohl-punctuation">&gt;</span></span>
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>xsl:template<span class="ohl-punctuation">&gt;</span></span></code></pre><p>We gradually reject XSL for our products for our own JavaScript based template engine <a href="https://github.com/veged/xjst">XJST</a>. This template engine absorbs all that we like in XSL, but implements it with JavaScript&apos;s productivity at either client or server side.<br/> We write our templates on domain specific language BEMHTML based on XJST. <a href="http://clubs.ya.ru/bem/replies.xml?item_no=992">The main ideas of BEMHTML</a> are published in BEM club at Ya.Ru (in Russian).</p><h2>Blocks reiteration</h2><p>The second <tt>Menu Block</tt> can occur in the <tt>Foot block</tt> of a site. Or one <tt>Text Block</tt> can turn into two separated by an advertisement.<br/> Even if a block was developed as a singular unit, the same one can appear at any moment.</p><p>From CSS&apos;s viewpoint this means that:</p><ul><li>CSS id selectors are not used<br/>
   It is convinient to use CSS classes</li></ul><p>From JavaScript&apos;s viewpoint this means that:</p><ul><li>The blocks with similar behaviour can be detected unequivocally: they have the same CSS classes<br/>
   Using CSS class selectors it is possible to pick out all the same blocks on the page, and to specify
   them the dynamic behaviour wanted.</li></ul><h2>Модифицируемость блоков и элементов</h2><p>Может возникнуть ситуация, в которой требуется не просто повторить блок, но и внести в него незначительные изменения.<br/> Например, стоит задача:</p><ul><li>Сделать в подвале ещё одно меню, с <i>другим дизайном</i>.</li></ul><div style="text-align: center">
<img src="images/site-footer-menu.png"/>
</div><p>Чтобы не разрабатывать рядом блок, минимально отличающийся от уже существующего, нужно воспользоваться <tt>модификатором</tt>.</p><p><tt>Модификатор</tt> — это свойство блока или элемента, которое немного меняет внешний вид или поведение.<br/> Модификатор имеет имя и значение. Одновременно может использоваться несколько разных модификаторов.</p><p><b>Приммер</b><br/> Модификатор блока задаёт ему цвет фона</p><div style="text-align: center">
<img src="images/search-background.png"/>
</div><p><b>Пример</b><br/> Модификатор элемента для текущего пункта меню изменяет эго внешний вид</p><div style="text-align: center">
<img src="images/menu-current-item.png"/>
</div><p>С точки зрения входных данных:</p><ul><li>В БЭМ-дереве модификаторы представлены как свойства той сущности, которая описывает блок или элемент</li></ul><p>Например, в XML это могут быть атрибуты соответствующего узла:</p><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:menu <span class="ohl-name ohl-name-attribute">m:size<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>big<span class="ohl-punctuation">&quot;</span></span></span> <span class="ohl-name ohl-name-attribute">m:type<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>buttons<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  ...
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>b:menu<span class="ohl-punctuation">&gt;</span></span></code></pre><p>То же самое в формате JSON:</p><pre class="ohl ohl-js"><code><span class="ohl-punctuation">{</span>
  <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
  <span class="ohl-name">mods</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">[</span>
   <span class="ohl-punctuation">{</span> <span class="ohl-name">size</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>big<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
   <span class="ohl-punctuation">{</span> <span class="ohl-name">type</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>buttons<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-punctuation">}</span>
  <span class="ohl-punctuation">]</span>
<span class="ohl-punctuation">}</span></code></pre><p>C точки зрения CSS:</p><ul><li>Модификатор представляется дополнительным CSS-классом блока или элемента.</li></ul><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>ul <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu menu_size_big menu_type_buttons<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  ...
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>ul<span class="ohl-punctuation">&gt;</span></span></code></pre><pre class="ohl ohl-js"><code><span class="ohl-operator">.</span><span class="ohl-name">menu_size_big</span> <span class="ohl-punctuation">{</span>
  <span class="ohl-comment ohl-comment-single"><span class="ohl-punctuation">//</span> CSS code to change height</span>
<span class="ohl-punctuation">}</span>
<span class="ohl-operator">.</span><span class="ohl-name">menu_type_buttons</span> <span class="ohl-operator">.</span><span class="ohl-name">menu__item</span> <span class="ohl-punctuation">{</span>
  <span class="ohl-comment ohl-comment-single"><span class="ohl-punctuation">//</span> CSS code to change item&apos;s view</span>
<span class="ohl-punctuation">}</span></code></pre><p>Модифицируемость элементов реализуется по аналогии.</p><p>Например, модификатором можно обозначить текущий пункт меню:</p><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>b:menu<span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:item<span class="ohl-punctuation">&gt;</span></span>Index<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:item<span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:item <span class="ohl-name ohl-name-attribute">m:state<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>current<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>Products<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>e:item<span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:item<span class="ohl-punctuation">&gt;</span></span>Contact<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>e:item<span class="ohl-punctuation">&gt;</span></span>
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>b:menu<span class="ohl-punctuation">&gt;</span></span></code></pre><pre class="ohl ohl-js"><code><span class="ohl-punctuation">{</span>
  <span class="ohl-name">block</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
  <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">[</span>
    <span class="ohl-punctuation">{</span> <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>item<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>Index<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
    <span class="ohl-punctuation">{</span>
      <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>item<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span>
      <span class="ohl-name">mods</span><span class="ohl-operator">:</span> <span class="ohl-punctuation">{</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>state<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>current<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
      <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>Products<span class="ohl-punctuation">&apos;</span></span>
    <span class="ohl-punctuation">}</span><span class="ohl-punctuation">,</span>
    <span class="ohl-punctuation">{</span> <span class="ohl-name">elem</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>item<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-name">content</span><span class="ohl-operator">:</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>Contact<span class="ohl-punctuation">&apos;</span></span> <span class="ohl-punctuation">}</span>
  <span class="ohl-punctuation">]</span>
<span class="ohl-punctuation">}</span></code></pre><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>div <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>ul <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__layout<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>li <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__layout-unit<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>div <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__item<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>Index<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>div<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>li<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>li <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__layout-unit<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>div <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__item menu__item_state_current<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>Products<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>div<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>li<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>li <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__layout-unit<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
      <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>div <span class="ohl-name ohl-name-attribute">class<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>menu__item<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>Contact<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>div<span class="ohl-punctuation">&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>li<span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>ul<span class="ohl-punctuation">&gt;</span></span>
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>div<span class="ohl-punctuation">&gt;</span></span></code></pre><pre class="ohl ohl-js"><code><span class="ohl-operator">.</span><span class="ohl-name">menu__item_state_current</span> <span class="ohl-punctuation">{</span>
  <span class="ohl-name">font</span><span class="ohl-operator">-</span><span class="ohl-name">weight</span><span class="ohl-operator">:</span> <span class="ohl-name">bold</span><span class="ohl-punctuation">;</span>
<span class="ohl-punctuation">}</span></code></pre><h2>Предметная абстракция</h2><p>Если над проектом работает много людей, им нужно договариваться о предметной области. У всех блоков проекта должны быть однозначные имена, которые используются в коде.</p><p>Например, реализованный на сайте блок <tt>Облако тегов</tt> всегда называется <tt>tags</tt>, а каждый элемент (метка) в нём - <tt>tag</tt>. Это справедливо для любой технологии: CSS, JS, XSL, etc.</p><p>С точки зрения процесса разработки:</p><ul><li>Все участники процесса оперируют одними терминами</li></ul><p>С точки зрения CSS:</p><ul><li>CSS блоков и элементов можно описывать на псевдоязыке, который затем компилируется в чистый
   CSS согласно принятой схеме именования.</li></ul><pre class="ohl ohl-js"><code>  <span class="ohl-operator">.</span><span class="ohl-name">menu</span> <span class="ohl-punctuation">{</span>
    <span class="ohl-name">__layout</span> <span class="ohl-punctuation">{</span>
      <span class="ohl-name">display</span><span class="ohl-operator">:</span> <span class="ohl-name">inline</span><span class="ohl-punctuation">;</span>
    <span class="ohl-punctuation">}</span>
    <span class="ohl-name">__layout</span><span class="ohl-operator">-</span><span class="ohl-name">item</span> <span class="ohl-punctuation">{</span>
      <span class="ohl-name">display</span><span class="ohl-operator">:</span> <span class="ohl-name">inline</span><span class="ohl-operator">-</span><span class="ohl-name">block</span><span class="ohl-punctuation">;</span>
      <span class="ohl-operator">.</span><span class="ohl-operator">.</span><span class="ohl-operator">.</span>
    <span class="ohl-punctuation">}</span>
    <span class="ohl-name">__item</span> <span class="ohl-punctuation">{</span>
      <span class="ohl-name">_state_current</span> <span class="ohl-punctuation">{</span>
        <span class="ohl-name">font</span><span class="ohl-operator">-</span><span class="ohl-name">weight</span><span class="ohl-operator">:</span> <span class="ohl-name">bold</span><span class="ohl-punctuation">;</span>
      <span class="ohl-punctuation">}</span>
    <span class="ohl-punctuation">}</span>
  <span class="ohl-punctuation">}</span></code></pre><p>С точки зрения JavaScript:</p><ul><li>Не нужно обращаться к DOM-узлам блоков и элементов по имени класса</li></ul><pre class="ohl ohl-js"><code><span class="ohl-name">$</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu__item<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">click</span><span class="ohl-punctuation">(</span> <span class="ohl-operator">.</span><span class="ohl-operator">.</span><span class="ohl-operator">.</span> <span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span>
<span class="ohl-name">$</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu__item<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">addClass</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu__item_state_current<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span>
<span class="ohl-name">$</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">toggle</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu_size_big<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">toggle</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu_size_small<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span></code></pre><p>Схема именования CSS-классов для блоков и элементов может измениться. При использовании специальных JavaScript-функций для обращения к блокам и работы с их модификаторами нужно будет внести изменения только в эти функции</p><pre class="ohl ohl-js"><code><span class="ohl-name">Block</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">elem</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>item<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">click</span><span class="ohl-punctuation">(</span> <span class="ohl-operator">.</span><span class="ohl-operator">.</span><span class="ohl-operator">.</span> <span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span>
<span class="ohl-name">Block</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">elem</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>item<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">setMod</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>state<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>current<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span>
<span class="ohl-name">Block</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>menu<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-operator">.</span><span class="ohl-name">toggleMod</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>size<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>big<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>small<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span></code></pre><p>Приведённый здесь код - абстрактный. В реальных разработках мы используем JavaScript-ядро блока <tt>i-bem</tt> из библиотеки bem-bl: <a href="http://bem.github.com/bem-bl/sets/common-desktop/i-bem/i-bem.ru.html">http://bem.github.com/bem-bl/sets/common-desktop/i-bem/i-bem.ru.html</a></p><h2>Консистентность блока</h2><p>На нашем сайте реализован блок Кнопка, у которого есть динамическое поведение.</p><div style="text-align: center">
<img src="images/button.png"/>
</div><p>При наведении курсора на этот блок он меняет свой внешний вид.</p><div style="text-align: center">
<img src="images/button-cursor.png"/>
</div><p>Менеджер может попросить:</p><ul><li>Использовать такую же кнопку на другой странице</li></ul><p>Просто CSS-реализации блока недостаточно. Ведь в данном случае, чтобы полностью повторить блок, нужно повторить и его поведение, описанное в JavaScript.</p><p>Таким образом, блок должен знать о себе всё. То есть реализация блока подразумевает описание его внешнего вида и поведения во всех необходимых технологиях. Этот принцип мы называем <tt>мультилингвальность</tt>.</p><p><tt>Мультилингвальность</tt> - это описание блока на всех языках (технологиях), необходимых для его работы.</p><p>Если блок нужно представить на странице, у него должны быть реализованы технологии:</p><ul><li>шаблоны (XSL, TT2, JavaScript, и т.д.), превращающие декларацию блока на странице в HTML-код</li><li>CSS, отвечающий за внешний вид блока</li></ul><p>Когда у блока также есть динамическое поведение, к этому списку добавляются:</p><ul><li>JavaScript-реализация блока</li></ul><p>В список технологий входит всё, что относится к блоку, в том числе и:</p><ul><li>Картинки блока</li></ul><h2>Представление блоков на файловой системе</h2><h3>Однозначное положение кода</h3><h4>Именование файлов</h4><p>Если проект</p><ul><li>живёт долго и постоянно обрастает новыми сущностями</li></ul><p>Если команда разработки</p><ul><li>состоит из нескольких специалистов</li><li>растёт и изменяется (появляются новые люди)</li></ul><p>нужен способ быстро определять, где может находиться код блока.</p><p>Код блока легко искать, если он расположен в файлах, одноимённых ключевому слову блока:</p><pre>
menu.xsl
menu.js
menu.css
</pre><h4>Файловая независимость блока</h4><p>Может возникнуть задача</p><ul><li>использовать несколько блоков предыдущего проекта на новом проекте</li></ul><p>Чтобы легко делать это, реализацию блока (во всех технологиях) нужно уметь доставлять в другое место. Это может быть сделано при помощи копирования файлов или частичным чекаутом репозитория проекта-донора. И в том, и в другом случае удобно, чтобы все файлы, относящиеся к блоку, были объединены в одну папку:</p><pre>
menu/
  menu.xsl
  menu.js
  menu.css
</pre><h4>Файловая структура блока</h4><p>В процессе работы над проектом может возникнуть необходимость изменить какой-нибудь блок.</p><p>Менеджер может попросить:</p><ul><li>Изменить цвет <tt>активному пункту Меню</tt>, или</li><li>Сделать <tt>Меню</tt> реагирующим на наведение курсора</li></ul><p>Один разработчик может попросить другого:</p><ul><li>Помочь с вёрсткой <tt>Поисковой формы</tt> под IE</li></ul><p>Чтобы можно было сразу понять, где лежит код, о котором идёт речь, нужно соблюдать в разработке следующие требования:</p><ul><li>Код блока размещён в отдельной директории<ul><li>Имя директории совпадает с именем блока</li><li>Техническая реализация блока размещена в файлах в директории блока</li></ul></li><li>Элементу соответствует поддиректория в директории блока<ul><li>Имя директории совпадает с именем элемента</li><li>Техническая реализация элемента располагается в файлах в этой директории</li></ul></li><li>Модификатору соответствует поддиректория в директории блока<ul><li>Имя директории соответствует имени модификатора</li><li>Техническая реализация модификатора размещается в файлах в этой директории</li><li>Названия файлов содержат как имя, так и значение модификатора</li></ul></li></ul><p><b>Пример</b><br/> Файловая структура блока Меню</p><pre>
menu/
  __item/
    _state/
      menu__item_state_current.css
      menu__item_state_current.xsl
    menu__item.css
    menu__item.xsl
  menu.css
  menu.js
  menu.xsl
</pre><p>Поддерживать такую файловую структуру вручную неудобно. Для работы с файлами мы используем <a href="https://github.com/bem/bem-tools">БЭМ-инструменты</a>. Это набор утилит, позволяющий создавать файлы по определённым шаблонам и с определённой схемой расположения на файловой системе.</p><h4>Группировка блоков в папки</h4><p>На большом портале необходимо реализовывать одни и те же блоки на разных проектах.</p><p>Может возникнуть задача:</p><ul><li>Реализовать одинаковый Подвал <tt>на всех проектах Портала</tt>, или</li><li>Сделать  <tt>новый проект</tt>, используя блоки уже существующего</li></ul><p>Разработка сайтов один за другим в web-студии часто подразумевает использование типовых решений для типовых страниц.</p><p>Менеджер может попросить:</p><ul><li>Сделать Страницу заказа товара с формой <tt>как на позапрошлом проекте</tt></li></ul><p>Выполнять эти задачи нужно без копирования блоков из проекта в проект. Должна быть возможность подключить блоки одного проекта к другому. Для этого блоки нужно объединять в одну директорию.</p><p>Мы называем такую директорию <tt>blocks</tt>.</p><p><b>Пример</b></p><pre>
blocks/
  foot/
  head/
  menu/
  page/
  search/
</pre><p>Такую папку можно подключить к новому проекту прямо из репозитория. Так, код блока будет храниться только в одном месте. Если нужно исправить ошибку или внести другие изменения, это нужно будет сделать только там.</p><h3>Уровни переопределения</h3><p>Если группа блоков одного проекта (объединённая в папку) подключена к другому проекту напрямую (при помощи частичного чекаута или svn:externals), то любое закоммиченное изменение в таких блоках повлияет на оба проекта.</p><p>При разработке одного сайта на основе существующего может потребоваться:</p><ul><li>Увеличить шрифт в Шапке на всём сайте (не затрагивая предыдущий сайт),</li><li>Добавить анимацию для раскрытия всех выпадающих меню.</li></ul><p>То есть необходима возможность переопределять (или доопределять) блоки в разных технологиях только для определённого сайта или только для определённых страниц. Это возможно благодаря <tt>уровням переопределения</tt>.</p><p><tt>Уровень переопределения</tt> — это набор реализаций блоков, сгруппированных в одну директорию.</p><div style="text-align:center;">
<img src="images/levels-schema.png"/>
</div><p>Реализация любого блока библиотеки может быть расширена (или переопределена) на уровне проекта.</p><div style="text-align:center;">
<img src="images/block-levels.png"/>
</div><p>С точки зрения сборки страниц:</p><ul><li>При сборке каждой страницы можно указать список уровней (директорий), блоки которых будут
   представлены на странице. Например,<br/>
   <tt>build-page -l blocks-common -l blocks-my my-page.html</tt></li></ul><p>С точки зрения файловой структуры:</p><ul><li>Проект можно содержать любое количество реализаций блоков. Но на страницу попадут только те,
   которые явно указаны к применению для сборки этой страницы. Возможно делать разные наборы
   уровней переопределения для разных разделов сайтов.</li></ul><p>С точки зрения JavaScript</p><ul><li>Необходима возможность декларативного описания динамического поведения элементов на странице.
   Конечное поведение должно собираться с разных уровней переопределения. Например,</li></ul><pre class="ohl ohl-js"><code><span class="ohl-comment ohl-comment-multiline"><span class="ohl-punctuation">/*</span> blocks-common/dropdown/dropdown.js <span class="ohl-punctuation">*/</span></span>
<span class="ohl-name">Block</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>dropdown<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-punctuation">{</span>
  <span class="ohl-name">init</span><span class="ohl-operator">:</span> <span class="ohl-keyword ohl-keyword-declaration">function</span><span class="ohl-punctuation">(</span><span class="ohl-punctuation">)</span> <span class="ohl-punctuation">{</span>
    <span class="ohl-operator">.</span><span class="ohl-operator">.</span><span class="ohl-operator">.</span>
  <span class="ohl-punctuation">}</span>
<span class="ohl-punctuation">}</span><span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span>

<span class="ohl-comment ohl-comment-multiline"><span class="ohl-punctuation">/*</span> blocks-my/dropdown/dropdown.js <span class="ohl-punctuation">*/</span></span>
<span class="ohl-name">Block</span><span class="ohl-punctuation">(</span><span class="ohl-string ohl-string-single"><span class="ohl-punctuation">&apos;</span>dropdown<span class="ohl-punctuation">&apos;</span></span><span class="ohl-punctuation">,</span> <span class="ohl-punctuation">{</span>
  <span class="ohl-name">init</span><span class="ohl-operator">:</span> <span class="ohl-keyword ohl-keyword-declaration">function</span><span class="ohl-punctuation">(</span><span class="ohl-punctuation">)</span> <span class="ohl-punctuation">{</span>
    <span class="ohl-keyword">this</span><span class="ohl-operator">.</span><span class="ohl-name">__base</span><span class="ohl-punctuation">(</span><span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span>
    <span class="ohl-operator">.</span><span class="ohl-operator">.</span><span class="ohl-operator">.</span>
  <span class="ohl-punctuation">}</span>
<span class="ohl-punctuation">}</span><span class="ohl-punctuation">)</span><span class="ohl-punctuation">;</span></code></pre><p>С точки зрения шаблонного движка</p><ul><li>Для того, чтобы можно было не только переопределять, но и &quot;доопределять&quot; шаблон, нужна
   возможность вызвать предыдущую реализацию шаблона.<br/>
   Например, в случае xsl:</li></ul><pre class="ohl ohl-xml"><code><span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>xsl:template <span class="ohl-name ohl-name-attribute">match<span class="ohl-punctuation">=</span><span class="ohl-string ohl-string-double"><span class="ohl-punctuation">&quot;</span>b:head<span class="ohl-punctuation">&quot;</span></span></span><span class="ohl-punctuation">&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>div<span class="ohl-punctuation">&gt;</span></span> <span class="ohl-comment"><span class="ohl-punctuation">&lt;!--</span> Node for extra design <span class="ohl-punctuation">--&gt;</span></span>
    <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;</span>xsl:apply-imports<span class="ohl-punctuation">/&gt;</span></span>
  <span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>div<span class="ohl-punctuation">&gt;</span></span>
<span class="ohl-name ohl-name-tag"><span class="ohl-punctuation">&lt;/</span>xsl:template<span class="ohl-punctuation">&gt;</span></span></code></pre><p>С точки зрения архитектуры проекта</p><ul><li>При разработке портала из нескольких сайтов можно выделить общую библиотеку блоков, которая станет
   одним из уровней переопределения для всех сайтов портала. Блоки конкретного сайта — объединить в
   другой уровень переопределения.</li><li>В одном и том же репозитории может храниться реализация сайта для десктопных и мобильных браузеров.<br/>
   В таком проекте есть уровень переопределения для общей реализации блоков, для мобильной и для десктопной.
   Различные комбинации уровней дают желаемую реализацию блоков на конкретных страницах.</li></ul><p>Примером реализации нескольких уровней переопределения в одном репозитории может служить <a href="https://github.com/bem/bem-bl">Open Source библиотека блоков bem-bl</a>.</p><h2>Сборка страниц</h2><p>Работа со страницей в терминах блоков подразумевает <tt>предметную абстракцию</tt>. Эта предметная абстракция обязательна только на уровне взаимодействия человека с кодом. Когда код попадает в браузер, наличие предметной абстракции не обязательно, важно лишь сохранить требуемый внешний вид и поведение блоков на странице.</p><p>Таким образом, <tt>код для людей</tt> и <tt>код для браузеров</tt> — не одно и то же:</p><ul><li>Человек пишет код блоков, браузер получает код целой страницы</li></ul><p>Для того, чтобы превратить &quot;код для людей&quot; в &quot;код для браузеров&quot;, существует понятие <tt>сборки страниц</tt>.</p><p><tt>Сборка страницы</tt> — это формирование кода страницы в различных технологиях (HTML, CSS, JavaScript) на основе декларативного описания страницы (XML, JSON) путём применения реализаций описыванных блоков.</p><p>С точки зрения CSS</p><ul><li>Файлы всех блоков собираются в один файл страницы<br/>
   Несмотря на то, что CSS для каждого блока, элемента и модификатора реализован в отдельном файле,
   для работы страницы нет необходимости подключать эти файлы as is. Всю необходимую CSS-реализацию
   страницы можно собрать в один файл. К тому же это решает проблемы: ограниченного количества импортов
   в IE, количества HTTP-запросов к серверу. Объединение всех CSS в один файл мы делаем при помощи
   утилиты <a href="https://github.com/veged/borschik">borschik</a>.</li><li>Браузер получает минимизированный код<br/>
   В процессе сборки можно минимизировать и оптимизировать CSS-код. Например, при помощи утилиты
   <a href="https://github.com/afelix/csso">CSSO</a></li><li>Каждый браузер получает CSS, написанный специально для него<br/>
   Есть возможность разделять CSS-реализации для разных браузеров и поставлять в каждый конкретный
   браузер только тот CSS, который нужен ему. Для этого можно использовать <a href="https://github.com/afelix/setochka">Сеточку, прототип</a></li></ul><p>С точки зрения JavaScript</p><ul><li>Много файлов для блоков, один файл для страницы<br/>
   Так же, как и в случае CSS, JavaScript-реализация всех необходимых блоков может быть объединена в один файл.</li></ul><p>С точки зрения шаблонных движков</p><ul><li>Работают только нужные шаблоны<br/>
   Конечный набор шаблонов, используемых для вывода HTML страницы в результате сборки содержит только
   шаблоны нужных блоков. Благодаря этому увеличивается производительность шаблонов и  уменьшается
   вероятность возникновения побочных эффектов.</li></ul><p>С точки зрения процесса разработки</p><ul><li>Роботы на службе у человека (не наоборот)<br/>
   Разработчик пишет код так, как ему удобно. О производительности заботятся роботы, которые в процессе
   сборки превращают код в оптимизированный (и, возможно, нечитаемый).</li></ul><p>С точки зрения организации труда</p><ul><li>Разделение труда<br/>
   Существуют одни разработчики, создающие блоки, и существуют другие разработчики, занимающиеся
   оптимизацией конечного продукта.</li></ul><p>Для сборки файлов страниц используются <a href="https://github.com/bem/bem-tools">БЭМ-инструменты</a>.</p><h2>Связанные ссылки</h2><h3>Библиотеки</h3><ul><li><a href="http://bem.github.com/bem-bl/index.ru.html">Библиотека блоков, разрабатываемых по БЭМ-методу</a></li></ul><h3>Инструменты</h3><ul><li><a href="https://github.com/bem/bem-tools">Инструменты для работы с файлами по БЭМ-методу</a></li><li><a href="https://github.com/veged/borschik">Borschik</a><br/>
   Утилита для сборки статических файлов web-проектов в один.</li><li><a href="https://github.com/afelix/setochka">Сеточка, прототип</a><br/>
   Инструмент для выделения CSS-свойств исходного CSS в отдельные файлы. Также может
   использоваться для удаления этих свойств без записи.</li><li><a href="https://github.com/afelix/csso">CSSO</a><br/>
   Утилита, оптимизирующая CSS-код с учётом его структуры.</li></ul><h3>Дополнительная информация</h3><ul><li><a href="http://clubs.ya.ru/bem/posts.xml?tag=64664080">Видео выступлений и мастер-классов</a></li><li><a href="http://clubs.ya.ru/bem/">Клуб БЭМ на Я.ру</a></li></ul></div>
