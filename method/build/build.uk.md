# Збірка БЕМ-проекту

* [Введення](#Введення)
* [Етапи складання](#Етапи-складання)
* [Результат складання](#Результат-складання)
* [Інструменти для збірки](#Інструменти-для-збірки)

## Введення

У БЕМ-проекті код розділяється на [окремі файли](../filestructure/filestructure.uk.md#Принципи-організації-файлової-структури-БЕМ-проекту) (також звані вихідними файлами). Щоб об'єднати вихідні файли в один (наприклад, всі CSS-файли в `project.css`, всі JS файли `project.js` тощо), використовується збірка. Файли, отримані в результаті збирання, БЕМ-методології прийнято називати **бандлами**.

**Приклад**

![Збірка БЭМ-проекта](https://cdn.rawgit.com/bem-site/bem-method/bem-info-data/method/build/build__bem-project.svg)

Збірка вирішує наступні завдання:

* Об'єднує вихідні файли, розкладені по файловій структурі проекту.
* Підключає в проект тільки необхідні блоки, елементи і модифікатори ([БЕМ-сутності](../key-concepts/key-concepts.uk.md#БЕМ-сутність)).
* Враховує порядок підключення.
* Обробляє код вихідних файлів в процесі складання (наприклад, компілює [LESS-код](https://ru.wikipedia.org/wiki/LESS_(язык_стилей)) в CSS-код).

## Етапи складання

Щоб в результаті складання отримати бандли, необхідно визначити:

1. [Список БЕМ-сутностей](#Список-БЕМ-сутностей)
2. [Залежності між ними](#Опис-залежностей)
3. [Порядок їх підключення](#Порядок-підключення-БЕМ-сутностей-в-збірку)

### Список БЕМ-сутностей

Щоб включити в збірку тільки необхідні БЕМ-суті, потрібно скласти список блоків, елементів і модифікаторів, використовуваних на сторінці. Такий список зветься [декларацією](../declarations/declarations.uk.md). Він дозволяє позбутися від непотрібного коду, який значно збільшує обсяг бандлів.

Інструмент збірки, грунтуючись на даних зі списку, додає в бандли тільки перераховані БЕМ-сутності. Нижче наведено приклад складання бандлів на основі декларації.

**Приклад**

![Збірка БЭМ-проекта](https://cdn.rawgit.com/bem-site/bem-method/bem-info-data/method/build/build__declaration.svg)

> Детальніше про те, як побудувати декларацію, див. у розділі [Способи отримання декларації](../declarations/declarations.uk.md#Способи-одержання-декларації).

### Опис залежностей

У БЕМ блоки можуть будуватися на підставі інших блоків. Для цього необхідно вказати залежності від них. Залежності дозволяють позбутися від непотрібного «Copy-Paste».

Інструмент збірки отримує дані про залежності і додає всі БЕМ-суті, необхідні для реалізації блоку. Нижче наведено приклад складеного блоку.

**Приклад**

![Приклад складеного блоку](https://cdn.rawgit.com/bem-site/bem-method/bem-info-data/method/build/build__search-form.svg)

> Детальніше про те, як описати залежності від інших БЕМ-сутностей і технологій, див. у розділі [Технологія для опису залежностей](https://uk.bem.info/platform/deps/).

### Порядок підключення БЕМ-сутностей в збірку

Порядок підключення БЕМ-сутностей в збірку залежить від:

* вказаних залежностей;
* використовуваних рівнів перевизначення.

#### Залежності і порядок підключення БЕМ-сутностей в збірку

У БЕМ залежності можуть впливати на порядок підключення БЕМ-сутностей в збірку. Механізм підключення залежить від використовуваних [DEPS-сутностей](https://uk.bem.info/platform/deps/), які по-різному впливають на пріоритет підключення.

> Детальніше про те, як визначити порядок підключення БЕМ-сутностей в збірку, див. у розділі [Синтаксис DEPS](https://uk.bem.info/platform/deps/).

#### Рівні перевизначення і порядок підключення БЕМ-сутностей в збірку

У БЕМ кінцева реалізація блоку може бути поділена за різними [рівнями перевизначення](../key-concepts/key-concepts.uk.md#Рівень-перевизначення). Вони дозволяють змінювати уявлення і поведінку блоків для різних платформ. Кожен наступний рівень доповнює або перекриває вихідну реалізацію блоку. Тому важливо, щоб спочатку в збірку потрапляла вихідна реалізація, а потім зміни зі всіх рівнів перевизначення. Нижче наведено приклад проекту з рівнями перевизначення: `common.blocks`, `desktop.blocks`, `touch.blocks`. Порядок складання визначений цифрами.

**Приклад**

![Рівні переопределения](https://cdn.rawgit.com/bem-site/bem-method/bem-info-data/method/build/build__levels.svg)

> Докладно про те, як використовувати рівні перевизначення, див. у розділі [Рівні перевизначення](../redefinition-levels/redefinition-levels.ru.md).

## Результат складання

В результаті збірки можна отримати файли для:

* фрагмента сторінки (наприклад, `header.css` або `footer.css`);
* окремої сторінки (наприклад, `hello.css` і `hello.js`);
* всього проекту (наприклад, `project.css` і `project.js`).

При складанні окремої сторінки/проекту в результуючий код можуть бути включені:

* всі БЕМ-суті з файлової структури проекту (значно збільшує обсяг коду);
* тільки необхідні БЕМ-сутності.

Нижче наведено приклад складання сторінки `hello`.

**Приклад**

Файлова структура БЕМ-проекту до збірки:

```files
blocks/                 # Директорія, що містить блоки

bundles/                # Директорія, що містить результати складання (опціонально)
    hello/              # Директорія сторінки hello (створюється вручну)
        hello.decl.js   # Список БЕМ-сутностей, необхідних для сторінки hello
```

Файлова структура БЕМ-проекту після збірки:

```files
blocks/

bundles/
    hello/
        hello.decl.js
        hello.css       # Зібраний CSS-файл сторінки hello (бандл hello в технології CSS)
        hello.js        # Зібраний JS-файл сторінки hello (бандл hello в технології JS)
```

## Інструменти для збірки

БЕМ-методологія не обмежує вибір інструменту для збірки.

У БЕМ-платформі використовуються такі збирачі:

* [ENB](https://uk.bem.info/toolbox/enb/)

  > Докладно про те, як зібрати БЕМ-проект з допомогою ENB, див. у розділі [Створюємо проект по БЕМ](https://uk.bem.info/platform/tutorials/start-with-project-stub/).

* [Gulp](http://gulpjs.com/)

  > Докладно про те, як зібрати БЕМ-проект з допомогою Gulp, див. вебінар [Декларативний JavaScript по БЕМ](https://uk.bem.info/forum/-696/).
